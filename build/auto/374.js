"use strict";(self.webpackChunkphoenix_press=self.webpackChunkphoenix_press||[]).push([[374],{2590:function(e,t,n){var a=n(9502),l=n(900);t.A=({index:e})=>0===e&&React.createElement(React.Fragment,null,LOCALIZED.DISCLAIMER_MESSAGE&&React.createElement(a.A,{severity:"info",sx:{padding:"1rem"}},(0,l.Ay)(LOCALIZED.DISCLAIMER_MESSAGE)))},8374:function(e,t,n){n.r(t),n.d(t,{default:function(){return J}});var a=n(4977),l=n(7458),r=n(1609),o=n.n(r),i=n(4164),c=n(5659),s=n(1848),u=n(5607),d=n(8413),m=n(3990);function p(e){return(0,m.Ay)("MuiCardActions",e)}(0,d.A)("MuiCardActions",["root","spacing"]);var h=n(790);const g=(0,s.Ay)("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableSpacing&&t.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]});var v=r.forwardRef((function(e,t){const n=(0,u.b)({props:e,name:"MuiCardActions"}),{disableSpacing:a=!1,className:l,...r}=n,o={...n,disableSpacing:a},s=(e=>{const{classes:t,disableSpacing:n}=e,a={root:["root",!n&&"spacing"]};return(0,c.A)(a,p,t)})(o);return(0,h.jsx)(g,{className:(0,i.A)(s.root,l),ownerState:o,ref:t,...r})})),f=n(6990),E=n(7636),b=n(9502),y=n(3899),A=n(7164),C=n(3551),w=n(3650),_=n(6087),R=n(5737),S=n(8014),k=n(2687),x=n(8870),I=n(267),L=n(3357),T=n(8429),D=n(1769);const M=e=>{const t={};if(!e)return t;const n=e.find((e=>e.types.includes("street_number")))?.long_name,a=e.find((e=>e.types.includes("route")))?.short_name;return t.address_1=n&&a?`${n} ${a}`:"",t.city=e.find((e=>e.types.includes("locality")))?.long_name||"",t.state=e.find((e=>e.types.includes("administrative_area_level_1")))?.short_name||"",t.country=e.find((e=>e.types.includes("country")))?.short_name||"",t.zipcode=e.find((e=>e.types.includes("postal_code")))?.long_name||"",t},P=["places"];function N({input:e,handleBlur:t}){const[n,a]=(0,_.useState)(!1),[r,o]=(0,_.useState)({}),i=(0,_.useRef)(null),{isLoaded:c,loadError:s}=(0,D.RH)({googleMapsApiKey:LOCALIZED?.GMAPS_API_KEY,libraries:P});(0,_.useEffect)((()=>{if(!i.current||!window.google)return;const e=new window.google.maps.places.Autocomplete(i.current);return e.addListener("place_changed",(()=>{try{const t=e.getPlace(),n=M(t.address_components);u(n)}catch(e){console.error("Error handling place_changed event:",e)}})),()=>{window.google.maps.event.clearInstanceListeners(e)}}),[c]);const u=t=>{t.nativeEvent instanceof Event?e.value=t.target.value:(e.obj=t,e.value=`${t.address_1}, ${t.city}, ${t.state} ${t.zipcode}`);const n=d(e);o((t=>({...t,[e.name]:n})))},d=e=>{if(!e.optional)return e.value.trim()?"":"This field is required"};return s?(console.error("Error loading maps:",s),React.createElement("div",null,"Error loading maps")):c?React.createElement(y.A,{spacing:2,direction:"column",sx:{marginTop:"1rem",display:"flex",width:"100%"}},React.createElement(I.A,{label:e.label,name:e.name,value:e.value,onChange:u,onBlur:t,variant:"outlined",margin:"normal",fullWidth:!0,inputRef:i,InputProps:{endAdornment:n?React.createElement(L.A,{size:20}):null},required:!e.optional,error:!!r[e.name],helperText:r[e.name]}),React.createElement(f.A,{variant:"contained","aria-label":"Use my location",color:"primary",onClick:()=>{navigator.geolocation?(a(!0),navigator.geolocation.getCurrentPosition((e=>{const{latitude:n,longitude:l}=e.coords;(new window.google.maps.Geocoder).geocode({location:{lat:n,lng:l}},((e,n)=>{if(a(!1),"OK"===n&&e[0]){const n=M(e[0].address_components);u(n),t()}else console.error("Geocoder failed due to:",n)}))}),(e=>{a(!1),console.error("Error in getting geolocation:",e)}))):console.error("Geolocation is not supported by your browser.")},disabled:n},n?React.createElement(L.A,{size:20}):React.createElement(T.A,null),"Use My Current Location")):React.createElement(l.A,null)}function O({input:e,setValidPhoneNumber:t,handleBlur:n}){const[a,l]=(0,_.useState)({});return React.createElement(I.A,{label:e.label,name:e.name,value:e.value,onChange:n=>{const{value:r}=n.target,o=(e=>{const t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`})(r),i=(e=>{const n=10!==e.replace(/\D/g,"").length;return t(!0),n?"Valid phone number is required.":""})(o);l({...a,[e.name]:i}),e.value=o},onBlur:n,fullWidth:!0,variant:"outlined",margin:"normal",type:"tel",required:!e.optional,error:!!a[e.name],helperText:a[e.name]})}var B=n(779),$=n(8864),q=n(5724),V=n(7558),Z=n(9307),j=n(4368);function z({input:e,handleBlur:t}){const[n,a]=(0,_.useState)([]),l=e=>{const{value:n,checked:l}=e.target;a((e=>l?[...e,n]:e.filter((e=>e!==n)))),t()};return(0,_.useEffect)((()=>{if(j.A&&n.length>0){const t=j.A.filter((e=>n.includes(e.value)));e.value=t.map((e=>({value:e.value,id:e.id})))}}),[n]),React.createElement(B.A,{component:"fieldset",fullWidth:!0,margin:"dense"},React.createElement(Z.A,{component:"legend"},"Select desired service(s)"),React.createElement(q.A,null,React.createElement(A.A,{sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:1,padding:0}},j.A&&j.A?.map((e=>React.createElement($.A,{sx:{margin:0},control:React.createElement(V.A,{value:e.value,checked:n.includes(e.value),onChange:l,name:e.name,size:"small"}),label:e.text}))))))}var U=n(900),W=({input:e,handleTextChange:t,handleDateChange:n,handleConsentChange:a,selectedDate:l,setValidPhoneNumber:r,checked:o,handleBlur:i})=>{switch((0,_.useEffect)((()=>("datetime"===e.type&&n({input:e,event:l}),()=>{})),[e,l,n]),e.type){case"tel":return React.createElement(O,{input:e,setValidPhoneNumber:r,handleBlur:i});case"text":return React.createElement(I.A,{label:e.label,name:e.name,onChange:n=>t({input:e,event:n}),onBlur:i,fullWidth:!0,variant:"outlined",margin:"normal",required:!e.optional});case"geo":return React.createElement(N,{input:e,handleBlur:i});case"select":return React.createElement(z,{input:e,handleBlur:i});case"checkbox":return React.createElement($.A,{sx:{marginBottom:"1rem"},control:React.createElement(V.A,{checked:o,onChange:t=>a({input:e,event:t}),onBlur:i,name:e.name,required:!e.optional}),label:(0,U.Ay)(LOCALIZED.SMS_CONSENT_MESSAGE||e.label)});case"datetime":return React.createElement(R.$,{dateAdapter:x.h},React.createElement(y.A,{direction:"row",spacing:4,sx:{marginTop:"1rem",justifyContent:"space-around",width:"100%"}},React.createElement(S.l,{label:"Select Date",value:l,onChange:t=>n({input:e,event:t}),onAccept:i,disablePast:!0,fullWidth:!0}),React.createElement(k.A,{label:"Select Time",value:l,onChange:t=>n({input:e,event:t}),onAccept:i,fullWidth:!0})));default:return null}},F=n(2590),G=[{name:"full_name",type:"row",title:"Contact Information",label:"Please enter your contact information.",inputs:[{name:"full_name",type:"text",label:"Enter your name",value:"",optional:!0}]},{name:"phone",inputs:[{name:"phone",type:"tel",label:"Enter your phone number",value:"",optional:!1},{name:"sms_consent",type:"checkbox",label:"Yes, send me SMS updates and notifications to keep me informed about my roadside service request.",value:!1,optional:!0}]},{name:"service_time",type:"row",title:"When do you need service?",label:"Please verify service date and time.",inputs:[{value:"",type:"datetime",name:"service_time",selected:"",optional:!1}]},{name:"location",type:"row",title:"Where is the vehicle located?",label:"Please verify service location.",inputs:[{name:"location",type:"geo",label:"Search for your location",value:"",obj:{},optional:!0}]},{type:"row",title:"Vehicle Details",label:"Year, Make, Model, and Color",inputs:[{name:"car_year",type:"text",label:"Year",value:"",optional:!0},{name:"car_make",type:"text",label:"Make",value:"",optional:!0},{name:"car_model",type:"text",label:"Model",value:"",optional:!0},{name:"car_color",type:"text",label:"Color",value:"",optional:!0}]},{name:"service_type",inputs:[{value:[],valueId:null,type:"select",name:"service_type",optionsKey:"serviceOptions",options:[],optional:!1}]},{inputs:[{name:"notes",type:"text",label:"Additional Information",value:"",optional:!0}]}];const K=["full_name","phone","service_time","location","service_type"],Y={full_name:e=>""!==e.trim(),phone:e=>""!==e.trim(),service_time:e=>!isNaN(new Date(e).getTime()),location:e=>""!==e.trim(),service_type:e=>Array.isArray(e)&&e.length>0},H=(e,t)=>t.every((t=>((e,t)=>{const n=t.find((t=>t.name===e));return n&&Y[e](n.value)})(t,e)));function J(){const[e,t]=(0,r.useState)({questions:G||[],validPhoneNumber:!1,loading:!1,submitted:!1,formSubmissionId:null,selectedDate:new Date,checked:!1,turnstileToken:null,error:""}),n=(0,r.useRef)(null);(0,r.useEffect)((()=>{let e;return window?.turnstile&&n.current&&(e=window.turnstile.render(n.current,{sitekey:LOCALIZED.TURNSTILE_SITE_KEY,callback:e=>{t((t=>({...t,turnstileToken:e})))},"expired-callback":()=>{window.turnstile.reset(e)}})),()=>{e&&window.turnstile.remove(e)}}),[]);const i=async(n=!1)=>{if(!e.validPhoneNumber)return t((e=>({...e,error:"Phone number is required.",submitted:!n&&e.submitted}))),!1;n&&t((e=>({...e,submitted:!0})));try{t((e=>({...e,loading:!0})));const a=e.questions.flatMap((e=>e.inputs.map((e=>{const{name:t,value:n,obj:a}=e;return a?{name:t,value:n,obj:a}:{name:t,value:n}})))),l={"Content-Type":"application/json","X-Turnstile-Token":e.turnstileToken},r=window.location.origin.replace(/^https?:\/\//,"")+window.location.pathname.replace(/\/$/,""),o=H(a,K);if(e.formSubmissionId)await fetch(`${LOCALIZED.API_URL}/submit-lead-form/${e.formSubmissionId}`,{method:"PUT",headers:l,body:JSON.stringify({submission:a,source:r,completed:o,submitted:n})});else{const e=await fetch(`${LOCALIZED.API_URL}/submit-lead-form`,{method:"POST",headers:l,body:JSON.stringify({submission:a,source:r,completed:o,submitted:n})}),i=await e.json();i?.id&&t((e=>({...e,formSubmissionId:i.id})))}if(n){const t=e.questions.find((e=>"full_name"===e.name))?.inputs[0]?.value||"";window.location.assign(`/book-success?full_name=${encodeURIComponent(t)}`)}}catch(e){console.error("There was an error",e)}finally{t((e=>({...e,loading:!1})))}},c=({input:e,event:t})=>{e.value=t?.target?.value},s=({input:e,event:n})=>{e.value=n,t((e=>({...e,selectedDate:n})))},u=()=>{e.validPhoneNumber&&e.turnstileToken&&!e.loading&&i()},d=({input:e,event:n})=>{const{checked:a}=n?.target;e.value=a,t((e=>({...e,checked:a}))),u()};return o().createElement("section",null,o().createElement(a.A,{className:"phoenix-form"},LOCALIZED.FORM_TITLE&&o().createElement(w.A,{title:LOCALIZED.FORM_TITLE,subheader:LOCALIZED.FORM_SUBTITLE}),o().createElement("form",{"aria-label":"Booking Form",autoComplete:"on",noValidate:!0},o().createElement(E.A,null,o().createElement(y.A,{space:4},e.questions?.map(((n,a)=>o().createElement(o().Fragment,{key:a},"row"===n.type?o().createElement(o().Fragment,null,o().createElement(C.A,{variant:"subtitle1",sx:{mt:"1rem"},color:"textSecondary"},n.title,o().createElement(C.A,{variant:"subtitle2",color:"textSecondary"},n.label)),o().createElement(A.A,{display:"flex",flexDirection:"row",sx:{width:"100%"},gap:2},n.inputs.map(((n,a)=>o().createElement(W,{key:a,input:n,handleTextChange:c,handleDateChange:s,handleConsentChange:d,selectedDate:e.selectedDate,setValidPhoneNumber:e=>t((t=>({...t,validPhoneNumber:e}))),checked:e.checked,setChecked:e=>t((t=>({...t,checked:e}))),handleBlur:u}))))):n.inputs.map(((n,a)=>o().createElement(W,{key:a,input:n,handleTextChange:c,handleDateChange:s,handleConsentChange:d,selectedDate:e.selectedDate,setValidPhoneNumber:e=>t((t=>({...t,validPhoneNumber:e}))),checked:e.checked,setChecked:e=>t((t=>({...t,checked:e}))),handleBlur:u}))))))),o().createElement(A.A,null,o().createElement(F.A,{index:0})),e.error&&o().createElement(A.A,{sx:{mt:2}},o().createElement(b.A,{severity:"warning"},e.error))),o().createElement(v,{sx:{justifyContent:"end"}},o().createElement(A.A,null,e.loading&&!e.submitted&&o().createElement(C.A,null,"Autosaving..."),e.loading&&e.submitted&&o().createElement(C.A,null,"Submitting...")),o().createElement(f.A,{size:"large",variant:"contained",color:"primary",onClick:()=>{i(!0)},loading:e.submitted},"Submit")),e.loading||!e.turnstileToken&&o().createElement(l.A,null),o().createElement("div",{ref:n,id:"turnstile-widget",className:"cf-turnstile"}))))}},8429:function(e,t,n){function a(){return React.createElement("svg",{style:{width:"20px",height:"20px",marginRight:"0.5rem",fill:"white"},className:"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1iirmgg",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"MyLocationIcon"},React.createElement("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}))}n.d(t,{A:function(){return a}})}}]);