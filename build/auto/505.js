"use strict";(self.webpackChunkphoenix_press=self.webpackChunkphoenix_press||[]).push([[505],{505:function(e,t,n){n.r(t),n.d(t,{default:function(){return Z}});var a=n(6087),r=n(6990),l=n(4977),o=n(7636),i=n(3899),c=n(7164),s=n(3650),u=n(7458),m=n(1385),d=n(900),p=n(8168),g=e=>React.createElement(o.A,(0,p.A)({sx:{backgroundColor:"#f0f0f0",borderRadius:"20px",padding:"10px 15px",position:"relative",maxWidth:"80%"}},e)),f=({question:e})=>{var t;const n=null!==(t=LOCALIZED?.ASSETS_URL)&&void 0!==t?t:"";return React.createElement(i.A,{direction:"row",spacing:2,alignItems:"flex-start"},React.createElement(m.A,{src:`${n}/avatar.jpg`,alt:"Technician Avatar"}),React.createElement(g,null,React.createElement("label",null,(0,d.Ay)(e.prompt))))},h=n(1405),E=n(267),v=n(8864),R=n(5737),A=n(8014),y=n(2687),b=n(8870),x=n(8429),w=n(1769),C=n(8292);const _=e=>{const t={};if(!e)return t;const n=e.find((e=>e.types.includes("street_number")))?.long_name,a=e.find((e=>e.types.includes("route")))?.short_name;return t.address_1=n&&a?`${n} ${a}`:"",t.city=e.find((e=>e.types.includes("locality")))?.long_name||"",t.state=e.find((e=>e.types.includes("administrative_area_level_1")))?.short_name||"",t.country=e.find((e=>e.types.includes("country")))?.short_name||"",t.zipcode=e.find((e=>e.types.includes("postal_code")))?.long_name||"",t},S=["places"];function L({input:e}){const{questions:t,currentQuestionIndex:n,setQuestions:l,errors:o,setErrors:c}=(0,a.useContext)(C.q),[s,m]=(0,a.useState)(!1),d=(0,a.useRef)(null),{isLoaded:p,loadError:g}=(0,w.RH)({googleMapsApiKey:LOCALIZED?.GMAPS_API_KEY,libraries:S});(0,a.useEffect)((()=>{if(!d.current||!window.google)return;const e=new window.google.maps.places.Autocomplete(d.current);return e.addListener("place_changed",(()=>{try{const t=e.getPlace(),n=_(t.address_components);f(n)}catch(e){console.error("Error handling place_changed event:",e)}})),()=>{window.google.maps.event.clearInstanceListeners(e)}}),[p]);const f=e=>{try{const a=[...t],r=a[n].inputs.find((e=>"location"===e.name));e.nativeEvent instanceof Event?r.value=e.target.value:(r.obj=e,r.value=`${e.address_1}, ${e.city}, ${e.state} ${e.zipcode}`),l(a);const i=h(r);c({...o,[r.name]:i})}catch(e){console.error("Error handling input change:",e)}},h=e=>{if(!e.optional)return e.value.trim()?"":"This field is required"};return g?(console.error("Error loading maps:",g),React.createElement("div",null,"Error loading maps")):p?React.createElement(a.Suspense,{fallback:React.createElement(u.A,null)},React.createElement(i.A,{spacing:2,direction:"column",sx:{marginTop:"1rem"}},React.createElement(E.A,{label:e.label,name:e.name,value:e.value,onChange:f,variant:"outlined",margin:"normal",fullWidth:!0,inputRef:d,InputProps:{endAdornment:s?React.createElement(u.A,null):null},required:!e.optional,error:!!o[e.name],helperText:o[e.name]}),React.createElement(r.A,{variant:"contained","aria-label":"Use my location",color:"primary",onClick:()=>{navigator.geolocation?(m(!0),navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:n}=e.coords;(new window.google.maps.Geocoder).geocode({location:{lat:t,lng:n}},((e,t)=>{if(m(!1),"OK"===t&&e[0]){const t=_(e[0].address_components);f(t)}else console.error("Geocoder failed due to:",t)}))}),(e=>{m(!1),console.error("Error in getting geolocation:",e)}))):console.error("Geolocation is not supported by your browser.")},disabled:s},s?React.createElement(u.A,null):React.createElement(x.A,null),"Use My Current Location"))):React.createElement(u.A,null)}var I=n(779),T=n(5724),k=n(7558),q=n(6347),M=n(9307);function $({input:e}){const{questions:t,currentQuestionIndex:n,setQuestions:r,services:l,errors:o,setErrors:i}=(0,a.useContext)(C.q),[s,u]=(0,a.useState)([]),m=e=>{const{value:t,checked:n}=e.target;u((e=>n?[...e,t]:e.filter((e=>e!==t))))};(0,a.useEffect)((()=>{const e=[...t],a=e[n].inputs.find((e=>"service_type"===e.name)),c=l.filter((e=>s.includes(e.value)));a.value=c.map((e=>({value:e.value,id:e.id}))),r(e);const u=d(a);i({...o,[a.name]:u})}),[s]);const d=e=>{if(!e.optional)return e.value.length<1?"This field is required":""};return React.createElement(I.A,{component:"fieldset",fullWidth:!0,margin:"dense",error:o.service_type},React.createElement(M.A,{component:"legend"},"Select desired service(s)"),React.createElement(T.A,null,React.createElement(c.A,{className:"phoenix-conversational-form__service-select",sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:0,padding:0}},l.map((e=>React.createElement(v.A,{sx:{margin:0,padding:0,lineHeight:1},control:React.createElement(k.A,{value:e.value,checked:s.includes(e.value),onChange:m,name:e.name,size:"small"}),label:e.text}))))),React.createElement(q.A,null,o.service_type))}function D({input:e,onChange:t}){const{errors:n,setErrors:r}=(0,a.useContext)(C.q),l=e=>10!==e.replace(/\D/g,"").length?"Valid phone number is required.":"";return(0,a.useEffect)((()=>{const t=l(e.value);r({...n,[e.name]:t})}),[e.value,r,n,e.name]),React.createElement(E.A,{label:e.label,name:e.name,value:e.value,onChange:a=>{const{value:o}=a.target,i=(e=>{const t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`})(o),c=l(i);r({...n,[e?.name]:c}),t({target:{name:"phone",value:i}})},fullWidth:!0,variant:"outlined",margin:"normal",type:"tel",required:!e.optional,error:!!n[e.name],helperText:n[e.name],size:"small"})}var O=({question:e})=>{const{errors:t,setErrors:n}=(0,a.useContext)(C.q),{questions:r,setQuestions:l,currentQuestionIndex:o}=(0,a.useContext)(C.q),[c,s]=(0,a.useState)(new Date);(0,a.useEffect)((()=>{if(r){const e=[...r],t=e[o].inputs.find((e=>"service_time"===e.name));t&&(t.value=c,l(e))}}),[e,c]);const u=e=>{s(e)},m=e=>{const{name:a,value:i,type:c,checked:s}=e.target,u=[...r],m=u[o].inputs.find((e=>e.name===a));if(m.value="checkbox"===c?s:i,l(u),"text"===m.type||"checkbox"===m.type){const e=p(m);n({...t,[m.name]:e})}},p=e=>{if(!e.optional)switch(e.type){case"text":return e.value.trim()?"":"This field is required";case"checkbox":return e.value?"":"This field is required";default:return""}return""};return React.createElement(React.Fragment,null,e.inputs.map(((e,n)=>"tel"===e.type?React.createElement(D,{input:e,key:n,onChange:m}):"text"===e.type?React.createElement(E.A,{key:n,label:e.label,name:e.name,value:e.value,onChange:m,fullWidth:!0,variant:"outlined",margin:"normal",error:!!t[e.name],helperText:t[e.name],required:!e.optional,size:"small"}):"geo"===e.type?React.createElement(L,{input:e,key:n}):"select"===e.type?React.createElement($,{input:e,key:n}):"textarea"===e.type?React.createElement(E.A,{key:n,label:e.label,name:e.name,value:e.value,onChange:m,fullWidth:!0,required:!e.optional,variant:"outlined",margin:"normal",size:"small"}):"checkbox"===e.type?React.createElement(v.A,{key:n,control:React.createElement(h.A,{checked:e.value,onChange:m,name:e.name,required:!e.optional}),disableTypography:!0,className:"phoenix-conversational-form__consent-switch",label:(0,d.Ay)(LOCALIZED.SMS_CONTENT_MESSAGE||e.label)}):"datetime"===e.type?React.createElement(R.$,{dateAdapter:b.h,key:n},React.createElement(i.A,{direction:"row",spacing:2,sx:{marginTop:"1rem"}},React.createElement(A.l,{label:"Select Date",value:c,onChange:u,disablePast:!0,fullWidth:!0}),React.createElement(y.A,{label:"Select Time",value:c,onChange:u,fullWidth:!0}))):null)))},N=n(2590);function P(){return React.createElement("svg",{style:{width:"2rem",height:"2rem",marginRight:"0.5rem",fill:"#cf2e2e"},className:"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1iirmgg",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"CancelIcon"},React.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}))}var Z=()=>{const{questions:e,currentQuestionIndex:t,setCurrentQuestionIndex:n,submitted:m,setSubmitted:d,loading:p,setLoading:g,isFormVisible:h,setIsFormVisible:E,errors:v}=(0,a.useContext)(C.q),R=(0,a.useRef)(null),A=e[t],[y,b]=(0,a.useState)(!0),[x,w]=(0,a.useState)(null),[_,S]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=A.inputs.some((e=>v[e.name]));return b(e),()=>{b(!0)}}),[v]),(0,a.useEffect)((()=>{let e;return h&&window?.turnstile&&R.current&&(e=window.turnstile.render(R.current,{sitekey:LOCALIZED.TURNSTILE_SITE_KEY,callback:e=>{S(e)},"expired-callback":()=>{window.turnstile.reset(e)}})),()=>{e&&window.turnstile.remove(e)}}),[h]);const L=()=>{E(!h)};return React.createElement("section",null,!h&&React.createElement("button",{onClick:L,id:"phoenix-show-form-button","aria-label":"Show Lead Form",style:{background:LOCALIZED.CHAT_AVATAR?"none":"#4395ce"}},LOCALIZED.CHAT_AVATAR?React.createElement("img",{className:"phoenix-chat-avatar",src:LOCALIZED.CHAT_AVATAR,alt:"Phoenix Lead Form Chat Avatar"}):React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"e-font-icon-svg e-fas-comment-alt",viewBox:"0 0 512 512",width:"24",height:"24",fill:"#fff"},React.createElement("path",{d:"M448 0H64C28.7 0 0 28.7 0 64v288c0 35.3 28.7 64 64 64h96v84c0 9.8 11.2 15.5 19.1 9.7L304 416h144c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64z"}))),h&&React.createElement(l.A,{className:"phoenix-form"},React.createElement(s.A,{id:"phoenix-chat-form-header",action:React.createElement(r.A,{onClick:L,"aria-label":"close"},React.createElement(P,null))}),React.createElement(o.A,{sx:{paddingBottom:0}},React.createElement("form",{"aria-label":"Booking Form",autoComplete:"on",noValidate:!0},m&&React.createElement(f,{question:{prompt:"Saving your submission, please wait..."}}),!m&&React.createElement(React.Fragment,null,React.createElement(i.A,{space:2},React.createElement(f,{question:A}),React.createElement(O,{question:A})),!p&&React.createElement(i.A,{direction:"row",spacing:2,sx:{width:"100%",display:"flex",my:"1rem",justifyContent:t>0?"space-between":"flex-end"}},t>0&&React.createElement(r.A,{variant:"contained",onClick:()=>n(t-1)},"Back"),React.createElement(r.A,{sx:{justifySelf:"end"},variant:"contained",color:"primary",onClick:()=>{(async()=>{if(p||!_)return!1;try{g(!0);const a=e.flatMap((e=>e.inputs.map((e=>{const{name:t,value:n,obj:a}=e;return a?{name:t,value:n,obj:a}:{name:t,value:n}})))),r={"Content-Type":"application/json","X-Turnstile-Token":_},l=window.location.origin.replace(/^https?:\/\//,"")+window.location.pathname.replace(/\/$/,"");if(t+1===e.length)return await(async(t,n)=>{try{if(g(!0),d(!0),!x)return!1;await fetch(`${LOCALIZED.API_URL}/submit-lead-form/${x}`,{method:"PUT",headers:{"Content-Type":"application/json","X-Turnstile-Token":_},body:JSON.stringify({submission:t,completed:!0,source:n})});const a=e.find((e=>"full_name"===e.name))?.inputs[0]?.value||"";window.location.assign(`/book-success?full_name=${encodeURIComponent(a)}`)}catch(e){console.error("There was an error",e)}})(a,l);if(n(t+1),x)await fetch(`${LOCALIZED.API_URL}/submit-lead-form/${x}`,{method:"PUT",headers:r,body:JSON.stringify({submission:a,source:l})});else{const e=await fetch(`${LOCALIZED.API_URL}/submit-lead-form`,{method:"POST",headers:r,body:JSON.stringify({submission:a,source:l})}),t=await e.json();t?.id&&w(t?.id)}}catch(e){console.error("There was an error",e)}finally{g(!1)}})()},disabled:y,loading:p||!_},t+1===e.length?"Submit":"Next")),React.createElement(N.A,{index:t})),React.createElement(c.A,{spacing:2,className:"phoenix-no-select",sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"10px"}},(p||!_)&&React.createElement(u.A,{sx:{width:"100%"}})))),React.createElement("div",{ref:R,id:"conversation-turnstile-widget",className:"cf-turnstile"})))}},2590:function(e,t,n){var a=n(9502),r=n(900);t.A=({index:e})=>0===e&&React.createElement(React.Fragment,null,LOCALIZED.DISCLAIMER_MESSAGE&&React.createElement(a.A,{severity:"info",sx:{padding:"1rem"}},(0,r.Ay)(LOCALIZED.DISCLAIMER_MESSAGE)))},8429:function(e,t,n){function a(){return React.createElement("svg",{style:{width:"20px",height:"20px",marginRight:"0.5rem",fill:"white"},className:"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1iirmgg",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"MyLocationIcon"},React.createElement("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}))}n.d(t,{A:function(){return a}})}}]);