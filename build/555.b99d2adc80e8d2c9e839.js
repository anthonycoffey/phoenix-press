"use strict";(self.webpackChunkphoenix_press=self.webpackChunkphoenix_press||[]).push([[555],{6555:function(e,t,n){n.r(t),n.d(t,{default:function(){return Q}});var a=n(1609),r=n(3455),l=n(6087),i=n(5737),o=n(8014),s=n(2687),c=n(8870),u=n(4267),m=n(1769),d=n(7289);const{GlobalStateContext:p}="../state.js",g=MaterialUI.TextField,f=MaterialUI.LinearProgress,E=MaterialUI.Stack,h=MaterialUI.Button,v=e=>{const t={};if(!e)return t;const n=e.find((e=>e.types.includes("street_number")))?.long_name,a=e.find((e=>e.types.includes("route")))?.short_name;return t.address_1=n&&a?`${n} ${a}`:"",t.city=e.find((e=>e.types.includes("locality")))?.long_name||"",t.state=e.find((e=>e.types.includes("administrative_area_level_1")))?.short_name||"",t.country=e.find((e=>e.types.includes("country")))?.short_name||"",t.zipcode=e.find((e=>e.types.includes("postal_code")))?.long_name||"",t},y=["places"];function I({input:e}){const{questions:t,currentQuestionIndex:n,setQuestions:r,errors:i,setErrors:o}=(0,l.useContext)(p),[s,c]=(0,l.useState)(!1),u=(0,l.useRef)(null),{isLoaded:I,loadError:x}=(0,m.RH)({googleMapsApiKey:LOCALIZED?.GMAPS_API_KEY,libraries:y});(0,l.useEffect)((()=>{if(!u.current||!window.google)return;const e=new window.google.maps.places.Autocomplete(u.current);return e.addListener("place_changed",(()=>{try{const t=e.getPlace(),n=v(t.address_components);b(n)}catch(e){console.error("Error handling place_changed event:",e)}})),()=>{window.google.maps.event.clearInstanceListeners(e)}}),[I]);const b=e=>{try{const a=[...t],l=a[n].inputs.find((e=>"location"===e.name));e.nativeEvent instanceof Event?l.value=e.target.value:(l.obj=e,l.value=`${e.address_1}, ${e.city}, ${e.state} ${e.zipcode}`),r(a);const s=C(l);o({...i,[l.name]:s})}catch(e){console.error("Error handling input change:",e)}},C=e=>{if(!e.optional)return e.value.trim()?"":"This field is required"};return x?(console.error("Error loading maps:",x),(0,a.createElement)("div",null,"Error loading maps")):I?(0,a.createElement)(l.Suspense,{fallback:(0,a.createElement)(f,null)},(0,a.createElement)(E,{spacing:2,direction:"column",sx:{marginTop:"1rem"}},(0,a.createElement)(g,{label:e.label,name:e.name,value:e.value,onChange:b,variant:"outlined",margin:"normal",fullWidth:!0,inputRef:u,InputProps:{endAdornment:s?(0,a.createElement)(f,null):null},required:!e.optional,error:!!i[e.name],helperText:i[e.name]}),(0,a.createElement)(h,{variant:"contained","aria-label":"Use my location",color:"primary",onClick:()=>{navigator.geolocation?(c(!0),navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:n}=e.coords;(new window.google.maps.Geocoder).geocode({location:{lat:t,lng:n}},((e,t)=>{if(c(!1),"OK"===t&&e[0]){const t=v(e[0].address_components);b(t)}else console.error("Geocoder failed due to:",t)}))}),(e=>{c(!1),console.error("Error in getting geolocation:",e)}))):console.error("Geolocation is not supported by your browser.")},disabled:s},s?(0,a.createElement)(f,null):(0,a.createElement)(d.A,null),"Use My Current Location"))):(0,a.createElement)(f,null)}const x=MaterialUI.FormControl,b=MaterialUI.FormControlLabel,C=MaterialUI.FormGroup,w=MaterialUI.Checkbox,S=MaterialUI.Box,M=MaterialUI.FormHelperText,L=MaterialUI.FormLabel;function A({input:e}){const{questions:t,currentQuestionIndex:n,setQuestions:r,services:i,errors:o,setErrors:s}=(0,l.useContext)(u.q),[c,m]=(0,l.useState)([]),d=e=>{const{value:t,checked:n}=e.target;m((e=>n?[...e,t]:e.filter((e=>e!==t))))};(0,l.useEffect)((()=>{const e=[...t],a=e[n].inputs.find((e=>"service_type"===e.name)),l=i.filter((e=>c.includes(e.value)));a.value=l.map((e=>({value:e.value,id:e.id}))),r(e);const u=p(a);s({...o,[a.name]:u})}),[c]);const p=e=>{if(!e.optional)return e.value.length<1?"This field is required":""};return(0,a.createElement)(x,{component:"fieldset",fullWidth:!0,margin:"dense",error:o.service_type},(0,a.createElement)(L,{component:"legend"},"Select desired service(s)"),(0,a.createElement)(C,null,(0,a.createElement)(S,{sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:1,padding:0}},i.map((e=>(0,a.createElement)(b,{sx:{margin:0},control:(0,a.createElement)(w,{value:e.value,checked:c.includes(e.value),onChange:d,name:e.name,size:"small"}),label:e.text}))))),(0,a.createElement)(M,null,o.service_type))}const _=MaterialUI.TextField;function k({input:e,onChange:t}){const{errors:n,setErrors:r}=(0,l.useContext)(u.q),i=e=>10!==e.replace(/\D/g,"").length?"Valid phone number is required.":"";return(0,l.useEffect)((()=>{const t=i(e.value);r({...n,[e.name]:t})}),[e.value,r,n,e.name]),(0,a.createElement)(_,{label:e.label,name:e.name,value:e.value,onChange:a=>{const{value:l}=a.target,o=(e=>{const t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?`(${t.slice(0,3)}) ${t.slice(3)}`:`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`})(l),s=i(o);r({...n,[e?.name]:s}),t({target:{name:"phone",value:o}})},fullWidth:!0,variant:"outlined",margin:"normal",type:"tel",required:!e.optional,error:!!n[e.name],helperText:n[e.name]})}var U=n(900);const T=MaterialUI.TextField,q=MaterialUI.Stack,$=MaterialUI.Checkbox,O=MaterialUI.FormControlLabel;var D=({question:e})=>{const{errors:t,setErrors:n}=(0,l.useContext)(u.q),{questions:r,setQuestions:m,currentQuestionIndex:d}=(0,l.useContext)(u.q),[p,g]=(0,l.useState)(new Date);(0,l.useEffect)((()=>{if(r){const e=[...r],t=e[d].inputs.find((e=>"service_time"===e.name));t&&(t.value=p,m(e))}}),[e,p]);const f=e=>{g(e)},E=e=>{const{name:a,value:l,type:i,checked:o}=e.target,s=[...r],c=s[d].inputs.find((e=>e.name===a));if(c.value="checkbox"===i?o:l,m(s),"text"===c.type||"checkbox"===c.type){const e=h(c);n({...t,[c.name]:e})}},h=e=>{if(!e.optional)switch(e.type){case"text":return e.value.trim()?"":"This field is required";case"checkbox":return e.value?"":"This field is required";default:return""}return""};return(0,a.createElement)(a.Fragment,null,e.inputs.map(((e,n)=>"tel"===e.type?(0,a.createElement)(k,{input:e,key:n,onChange:E}):"text"===e.type?(0,a.createElement)(T,{key:n,label:e.label,name:e.name,value:e.value,onChange:E,fullWidth:!0,variant:"outlined",margin:"normal",error:!!t[e.name],helperText:t[e.name],required:!e.optional}):"geo"===e.type?(0,a.createElement)(I,{input:e,key:n}):"select"===e.type?(0,a.createElement)(A,{input:e,key:n}):"textarea"===e.type?(0,a.createElement)(T,{key:n,label:e.label,name:e.name,value:e.value,onChange:E,fullWidth:!0,multiline:!0,rows:2,required:!e.optional,variant:"outlined",margin:"normal"}):"checkbox"===e.type?(0,a.createElement)(O,{sx:{marginBottom:"1rem"},key:n,control:(0,a.createElement)($,{checked:e.value,onChange:E,name:e.name,required:!e.optional}),label:(0,U.Ay)(LOCALIZED.SMS_CONTENT_MESSAGE||e.label)}):"datetime"===e.type?(0,a.createElement)(i.$,{dateAdapter:c.h,key:n},(0,a.createElement)(q,{direction:"row",spacing:2,sx:{marginTop:"1rem"}},(0,a.createElement)(o.l,{label:"Select Date",value:p,onChange:f,disablePast:!0,fullWidth:!0}),(0,a.createElement)(s.A,{label:"Select Time",value:p,onChange:f,fullWidth:!0}))):null)))},F=n(4338);const N=MaterialUI.Button,P=MaterialUI.Card,R=MaterialUI.CardContent,j=MaterialUI.Stack,Z=MaterialUI.Box,B=MaterialUI.CardHeader,G=()=>(0,a.createElement)("svg",{className:"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1iirmgg",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"CancelIcon"},(0,a.createElement)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"})),z=MaterialUI.LinearProgress;var Q=()=>{const{questions:e,currentQuestionIndex:t,setCurrentQuestionIndex:n,loading:i,setLoading:o,submitted:s,setSubmitted:c,isFormVisible:m,setIsFormVisible:d,errors:p}=(0,l.useContext)(u.q),g=e[t],[f,E]=(0,l.useState)(!0),[h,v]=(0,l.useState)(!1),[y,I]=(0,l.useState)(null),[x,b]=(0,l.useState)(null);(0,l.useEffect)((()=>{const e=g.inputs.some((e=>p[e.name]));return E(e),()=>{E(!0)}}),[p]),(0,l.useEffect)((()=>{if(m&&window.turnstile){const e=window.turnstile.render("#conversation-turnstile-widget",{sitekey:LOCALIZED.TURNSTILE_SITE_KEY,callback:e=>{b(e)},"expired-callback":()=>{window.turnstile.reset(e)}})}}),[m]);const C=()=>{d(!m)};return(0,a.createElement)("section",null,(0,a.createElement)("button",{onClick:C,id:"phoenix-show-form-button","aria-label":"Show Lead Form"},(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"e-font-icon-svg e-fas-comment-alt",viewBox:"0 0 512 512",width:"24",height:"24",fill:"#fff"},(0,a.createElement)("path",{d:"M448 0H64C28.7 0 0 28.7 0 64v288c0 35.3 28.7 64 64 64h96v84c0 9.8 11.2 15.5 19.1 9.7L304 416h144c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64z"}))),m&&(0,a.createElement)(P,{className:"phoenix-form"},(0,a.createElement)(B,{action:(0,a.createElement)(N,{onClick:C,"aria-label":"close"},(0,a.createElement)(G,null))}),(0,a.createElement)(a.Fragment,null,s&&(0,a.createElement)(R,null,(0,a.createElement)(j,{space:2},(0,a.createElement)(r.A,{question:{prompt:LOCALIZED.SUBMISSION_MESSAGE}}))),!s&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(R,null,(0,a.createElement)(j,{space:2},(0,a.createElement)(r.A,{question:g}),(0,a.createElement)(D,{question:g})),(0,a.createElement)(j,{direction:"row",spacing:2,sx:{width:"100%",display:"flex",my:"1rem",justifyContent:t>0?"space-between":"flex-end"}},t>0&&(0,a.createElement)(N,{variant:"contained",onClick:()=>n(t-1)},"Back"),(0,a.createElement)(N,{sx:{justifySelf:"end"},variant:"contained",color:"primary",onClick:()=>{(async()=>{o(!0);const a=e.flatMap((e=>e.inputs.map((e=>{const{name:t,value:n,obj:a}=e;return a?{name:t,value:n,obj:a}:{name:t,value:n}})))),r={"Content-Type":"application/json","X-Turnstile-Token":x},l=window.location.origin.replace(/^https?:\/\//,"")+window.location.pathname.replace(/\/$/,"");if(t+1===e.length)return await(async(e,t)=>{try{o(!0),y&&await fetch(`${LOCALIZED.API_URL}/submit-lead-form/${y}`,{method:"PUT",headers:{"Content-Type":"application/json","X-Turnstile-Token":x},body:JSON.stringify({submission:e,completed:!0,source:t})}),window?.dataLayer&&window.dataLayer.push({event:"form_submit",submission:e,source:t,completed:!0}),c(!0)}catch(e){console.error("There was an error",e)}finally{o(!1)}})(a,l);n(t+1),h||(v(!0),window?.dataLayer&&window.dataLayer.push({event:"form_start"}));try{if(!x)return!1;if(y)await fetch(`${LOCALIZED.API_URL}/submit-lead-form/${y}`,{method:"PUT",headers:r,body:JSON.stringify({submission:a,source:l})});else{const e=await fetch(`${LOCALIZED.API_URL}/submit-lead-form`,{method:"POST",headers:r,body:JSON.stringify({submission:a,source:l})}),t=await e.json();t?.id&&I(t?.id)}}catch(e){console.error("There was an error",e)}finally{o(!1)}})()},disabled:f||i||!x},t+1===e.length?"Submit":"Next")),(0,a.createElement)(F.A,{index:t}),(0,a.createElement)(Z,{spacing:2,className:"phoenix-no-select",sx:{width:"100%",display:"flex",my:"1rem",justifyContent:"center",alignItems:"center",minHeight:"1rem"}},(i||!x)&&(0,a.createElement)(z,{sx:{width:"100%"}}))))),(0,a.createElement)("div",{id:"conversation-turnstile-widget",className:"cf-turnstile",style:{display:"flex",justifyContent:"center",margin:"1rem 0",padding:"1rem"},"data-sitekey":LOCALIZED.TURNSTILE_SITE_KEY})))}},4338:function(e,t,n){var a=n(1609),r=n(900);const l=MaterialUI.Alert;t.A=({index:e})=>0===e&&(0,a.createElement)(a.Fragment,null,LOCALIZED.DISCLAIMER_MESSAGE&&(0,a.createElement)(l,{severity:"info",sx:{padding:"1rem"}},(0,r.Ay)(LOCALIZED.DISCLAIMER_MESSAGE)))},7289:function(e,t,n){n.d(t,{A:function(){return r}});var a=n(1609);function r(){return(0,a.createElement)("svg",{style:{width:"20px",height:"20px",marginRight:"0.5rem",fill:"white"},className:"MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1iirmgg",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"MyLocationIcon"},(0,a.createElement)("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}))}},3455:function(e,t,n){n.d(t,{A:function(){return c}});var a=n(1609),r=n(900);const l=MaterialUI.CardContent;var i=e=>(0,a.createElement)(l,{sx:{backgroundColor:"#f0f0f0",borderRadius:"20px",padding:"10px 15px",position:"relative",maxWidth:"80%"},...e});const o=MaterialUI.Avatar,s=MaterialUI.Stack;var c=({question:e})=>{var t;const n=null!==(t=LOCALIZED?.ASSETS_URL)&&void 0!==t?t:"";return(0,a.createElement)(s,{direction:"row",spacing:2,alignItems:"flex-start"},(0,a.createElement)(o,{src:`${n}/avatar.jpg`,alt:"Technician Avatar"}),(0,a.createElement)(i,null,(0,a.createElement)("label",null,(0,r.Ay)(e.prompt))))}}}]);