"use strict";(self.webpackChunkphoenix_press=self.webpackChunkphoenix_press||[]).push([[782],{3782:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var n=a(1609),l=a(4977),i=a(3650),o=a(7636),r=a(5583),s=a(4073),c=a(3313),u=a(7458),m=a(8587),p=a(8168),d=a(4164),y=a(5659),h=a(1848),v=a(7362),f=a(8413),b=a(3990);function E(e){return(0,b.Ay)("MuiCardActions",e)}(0,f.A)("MuiCardActions",["root","spacing"]);var A=a(4848);const S=["disableSpacing","className"],w=(0,h.Ay)("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,!a.disableSpacing&&t.spacing]}})((({ownerState:e})=>(0,p.A)({display:"flex",alignItems:"center",padding:8},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})));var g=n.forwardRef((function(e,t){const a=(0,v.b)({props:e,name:"MuiCardActions"}),{disableSpacing:n=!1,className:l}=a,i=(0,m.A)(a,S),o=(0,p.A)({},a,{disableSpacing:n}),r=(e=>{const{classes:t,disableSpacing:a}=e,n={root:["root",!a&&"spacing"]};return(0,y.A)(n,E,t)})(o);return(0,A.jsx)(w,(0,p.A)({className:(0,d.A)(r.root,l),ownerState:o,ref:t},i))})),C=a(4798),_=[{name:"full_name",type:"row",title:"Contact Information",label:"Please enter your contact information.",inputs:[{name:"full_name",type:"text",label:"Enter your name",value:"",optional:!0}]},{name:"phone",inputs:[{name:"phone",type:"tel",label:"Enter your phone number",value:"",optional:!1},{name:"sms_consent",type:"checkbox",label:"Yes, send me SMS updates and notifications to keep me informed about my roadside service request.",value:!1,optional:!0}]},{name:"service_time",type:"row",title:"When do you need service?",label:"Please verify service date and time.",inputs:[{value:"",type:"datetime",name:"service_time",selected:"",optional:!1}]},{name:"location",type:"row",title:"Where is the vehicle located?",label:"Please verify service location.",inputs:[{name:"location",type:"geo",label:"Search for your location",value:"",obj:{},optional:!0}]},{type:"row",title:"Vehicle Details",label:"Year, Make, Model, and Color",inputs:[{name:"car_year",type:"text",label:"Year",value:"",optional:!0},{name:"car_make",type:"text",label:"Make",value:"",optional:!0},{name:"car_model",type:"text",label:"Model",value:"",optional:!0},{name:"car_color",type:"text",label:"Color",value:"",optional:!0}]},{name:"service_type",inputs:[{value:[],valueId:null,type:"select",name:"service_type",optionsKey:"serviceOptions",options:[],optional:!1}]},{inputs:[{name:"notes",type:"text",label:"Additional Information",value:"",optional:!0}]}];const L=["full_name","phone","service_time","location","service_type"],x=(e,t)=>t.every((t=>((e,t)=>{const a=t.find((t=>t.name===e));return a&&k[e](a.value)})(t,e))),k={full_name:e=>""!==e.trim(),phone:e=>""!==e.trim(),service_time:e=>!isNaN(new Date(e).getTime()),location:e=>""!==e.trim(),service_type:e=>Array.isArray(e)&&e.length>0},I=(0,n.lazy)((()=>Promise.resolve().then(a.bind(a,3455)))),T=(0,n.lazy)((()=>a.e(119).then(a.bind(a,3119)))),D=(0,n.lazy)((()=>Promise.resolve().then(a.bind(a,4338))));function O(){const[e]=(0,n.useState)(_||!1),[t,a]=(0,n.useState)(!1),[m,p]=(0,n.useState)(!1),[d,y]=(0,n.useState)(!1),[h,v]=(0,n.useState)(!1),[f,b]=(0,n.useState)(null),[E,A]=(0,n.useState)(new Date),[S,w]=(0,n.useState)(!1),[k,O]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(window.turnstile){const e=window.turnstile.render("#turnstile-widget",{sitekey:LOCALIZED.TURNSTILE_SITE_KEY,callback:e=>{O(e)},"expired-callback":()=>{window.turnstile.reset(e)}})}}),[]);const M=({input:e,event:t})=>{e.value=t?.target?.value},N=({input:e,event:t})=>{e.value=t,A(t)},P=(a=!1)=>{if(m||!t||!k)return!1;(async(a=!1)=>{if(!k&&!t)return!1;p(!0);const n=e.flatMap((e=>e.inputs.map((e=>{const{name:t,value:a,obj:n}=e;return n?{name:t,value:a,obj:n}:{name:t,value:a}})))),l={"Content-Type":"application/json","X-Turnstile-Token":k},i=window.location.origin.replace(/^https?:\/\//,"")+window.location.pathname.replace(/\/$/,"");if(!k)return!1;try{const e=x(n,L);if(f)await fetch(`${LOCALIZED.API_URL}/submit-lead-form/${f}`,{method:"PUT",headers:l,body:JSON.stringify({submission:n,source:i,completed:e})});else{h||(v(!0),window?.dataLayer&&window.dataLayer.push({event:"form_start"}));const t=await fetch(`${LOCALIZED.API_URL}/submit-lead-form`,{method:"POST",headers:l,body:JSON.stringify({submission:n,source:i,completed:e})}),a=await t.json();a?.id&&b(a?.id)}a&&y(!0)}catch(e){console.error("There was an error",e)}finally{p(!1)}})(a)},R=({input:e,event:t})=>{const{checked:a}=t?.target;e.value=a,w(a),P()};return(0,n.createElement)("section",null,(0,n.createElement)(l.A,{className:"phoenix-form"},LOCALIZED.FORM_TITLE&&(0,n.createElement)(i.A,{title:LOCALIZED.FORM_TITLE,subheader:LOCALIZED.FORM_SUBTITLE}),d&&(0,n.createElement)(o.A,null,(0,n.createElement)(r.A,{space:2},(0,n.createElement)(I,{question:{prompt:LOCALIZED.SUBMISSION_MESSAGE}}))),!d&&(0,n.createElement)("form",{"aria-label":"Form Description",autoComplete:"on",noValidate:!0},(0,n.createElement)(o.A,null,(0,n.createElement)(r.A,{space:4},e?.map(((e,t)=>"row"===e.type?(0,n.createElement)(n.Fragment,null,(0,n.createElement)(s.A,{variant:"subtitle1",sx:{mt:"1rem"},color:"textSecondary"},e.title,(0,n.createElement)(s.A,{variant:"subtitle2",color:"textSecondary"},e.label)),(0,n.createElement)(c.A,{key:t,display:"flex",flexDirection:"row",sx:{width:"100%"},gap:2},e.inputs.map(((e,t)=>(0,n.createElement)(T,{key:t,input:e,handleTextChange:M,handleDateChange:N,handleConsentChange:R,selectedDate:E,setValidPhoneNumber:a,checked:S,setChecked:w,handleBlur:P}))))):e.inputs.map(((e,t)=>(0,n.createElement)(T,{key:t,input:e,handleTextChange:M,handleDateChange:N,handleConsentChange:R,selectedDate:E,setValidPhoneNumber:a,checked:S,setChecked:w,handleBlur:P})))))),(0,n.createElement)(c.A,null,(0,n.createElement)(D,{index:0})),(0,n.createElement)("div",{id:"turnstile-widget",className:"cf-turnstile",style:{display:"flex",justifyContent:"center",margin:"1rem 0",padding:"1rem"},"data-sitekey":LOCALIZED.TURNSTILE_SITE_KEY}),(0,n.createElement)(n.Fragment,null,m&&(0,n.createElement)(u.A,null))),(0,n.createElement)(g,{sx:{justifyContent:"end"}},(0,n.createElement)(C.A,{variant:"contained",color:"primary",onClick:()=>{P(!0)},disabled:m||!t||!k},"Submit")))))}}}]);
//# sourceMappingURL=782.a866cd98d8c1c76f127d.js.map